@model IEnumerable<MvcTestApp.Models.ProductListModel>

@{
    ViewBag.Title = "ViewProduct";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    form {
        display: inline
    }
</style>

<h2>ViewProduct</h2>
    
<p>
    @using (Html.BeginForm("ExportExcel", "Product"))
    {
        <input type="button" class="btn btn-default" style="margin:5px" value="Add Product" onclick="location.href='@Url.Action("AddProduct", "Product")'" />
        <button type="submit" id="submitButton" class="btn btn-default">Export Excel</button>
    }
    @using (Html.BeginForm("ExportCsv", "Product"))
    {
    <button type="submit" id="submitButton" class="btn btn-default">Export CSV</button>
    }
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Product.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Product.Quantity)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Product.Price)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Category.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Category.Description)
        </th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Product.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Product.Quantity)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Product.Price)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Category.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Category.Description)
        </td>
        <td>
            @Html.ActionLink("Edit", "EditProduct", new { id = item.Product.ProductId }) |
            @Html.ActionLink("Details", "ViewProduct", "Product", new { id = item.Product.ProductId }) |
            @Html.ActionLink("Delete", "Delete", "Product", new { id = item.Product.ProductId }, new { onclick = "return confirm('Are sure wants to delete?');" })
        </td>
    </tr>
}

</table>
